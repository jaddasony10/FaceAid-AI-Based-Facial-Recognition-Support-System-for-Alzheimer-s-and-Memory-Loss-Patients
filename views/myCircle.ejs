<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Your Circle</title>

<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/3808de5cb1.js" crossorigin="anonymous"></script>

<style>
    /* Body & Animated Background */
    body {
        font-family: 'Montserrat', sans-serif;
        background: linear-gradient(135deg, #f5f7fa, #c3cfe2, #f5f7fa, #c3cfe2);
        background-size: 400% 400%;
        animation: bgAnimation 20s ease infinite;
        margin: 0;
        padding: 0;
        color: #333;
    }
    @keyframes bgAnimation {
        0% {background-position: 0% 50%;}
        50% {background-position: 100% 50%;}
        100% {background-position: 0% 50%;}
    }

    /* Header */
    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: rgba(255,255,255,0.2);
        backdrop-filter: blur(8px);
        padding: 0.8rem 2rem;
        position: sticky;
        top: 0;
        z-index: 100;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        animation: fadeDown 0.8s ease forwards;
    }
    @keyframes fadeDown {
        from { opacity: 0; transform: translateY(-20px);}
        to { opacity: 1; transform: translateY(0);}
    }

    .header img {
        cursor: pointer;
        filter: brightness(0.6);
        transition: transform 0.3s ease, filter 0.3s ease;
    }
    .header img:hover {
        transform: scale(1.1);
        filter: brightness(1);
    }

    .header .settings i {
        color: #6a11cb;
        transition: transform 0.3s ease, color 0.3s ease;
    }
    .header .settings i:hover {
        transform: scale(1.2) rotate(-10deg);
        color: #2575fc;
    }

    /* Title at top center */
    .page-title {
        text-align: center;
        font-weight: 700;
        font-size: 2rem;
        color: #4a0d66;
        margin: 1.5rem 0;
        text-shadow: 0 2px 5px rgba(0,0,0,0.1);
        animation: fadeUp 1s ease forwards;
    }
    @keyframes fadeUp {
        from {opacity: 0; transform: translateY(20px);}
        to {opacity: 1; transform: translateY(0);}
    }

    /* Container */
    .container {
        padding: 0 2rem 3rem 2rem;
        max-width: 1100px;
        margin: auto;
    }

    /* Card Grid */
    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
        gap: 2rem;
    }

    /* Individual Card */
    .card {
        background: white;
        border-radius: 16px;
        padding: 1rem;
        text-align: center;
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.05);
        transition: transform 0.35s ease, box-shadow 0.35s ease, background 0.35s ease;
        position: relative;
        overflow: hidden;
        cursor: pointer;
        opacity: 0;
        animation: fadeInCard 0.8s ease forwards;
    }
    @keyframes fadeInCard {
        from {opacity: 0; transform: translateY(20px);}
        to {opacity: 1; transform: translateY(0);}
    }

    /* Staggered card animation */
    <% for(let i=0;i<result.length;i++){ %>
    .card:nth-child(<%= i+1 %>) {
        animation-delay: <%= i*0.15 %>s;
    }
    <% } %>

    .card::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle at center, rgba(106,17,203,0.08) 0%, transparent 70%);
        transform: rotate(25deg);
        pointer-events: none;
    }

    .card:hover {
        transform: translateY(-10px) scale(1.03);
        box-shadow: 0 14px 35px rgba(106,17,203,0.2);
        background: linear-gradient(145deg, #f9f7ff, #e0e0ff);
    }

    .card img {
        width: 120px;
    height: 120px;
    border-radius: 50%; /* Makes it perfectly circular */
    object-fit: cover;
    margin-bottom: 1rem;
    border: 4px solid transparent; /* Remove rectangular border artifact */
    background: linear-gradient(135deg, #6a11cb, #2575fc);
    padding: 3px; /* Creates gradient border as padding */
    transition: transform 0.3s ease;
    display: block;
    margin-left: auto;
    margin-right: auto;
    }
    .card img:hover {
        transform: scale(1.05) rotate(-3deg);
    }

    .home-head {
        margin: 0.5rem 0;
        font-size: 1.2rem;
        font-weight: 600;
        color: #4a0d66;
    }
    .relation {
        color: gray;
        font-size: 0.9rem;
    }

    /* Reminder Section */
    #reminders {
        margin-top: 3rem;
        background: white;
        border-radius: 14px;
        padding: 1.5rem 2rem;
        box-shadow: 0 6px 20px rgba(0,0,0,0.08);
        animation: fadeUp 0.8s ease forwards;
    }
    #reminders table {
        width: 100%;
        margin-top: 1rem;
        border-collapse: collapse;
    }
    th, td {
        padding: 0.8rem;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }
    th {
        background: linear-gradient(135deg, #6a11cb, #2575fc);
        color: white;
    }
    tr:hover td {
        background: rgba(106,17,203,0.05);
        transition: background 0.3s ease;
    }

    /* Responsive */
    @media (max-width: 576px) {
        .grid {
            grid-template-columns: 1fr;
        }
    }
</style>
</head>

<body>
    <div class="header">
        <a href="/home"><img src="/img/back.png" alt="Back" height="40"></a>
        <div></div>
        <a href="/circleupload" class="settings"><i class="fas fa-plus fa-2x"></i></a>
    </div>

    <div class="container">
        <div class="page-title">Your Circle</div>

        <div class="grid">
            <% for(let i=0; i<result.length; i++){ %>
                <div class="card">
                    <% if(result[i].photos.length != 0){ 
                        var j = Math.floor(Math.random() * result[i].photos.length); %>
                        <img src="data:image/<%= result[i].photos[j].contentType %>;base64,<%= result[i].photos[j].data.toString('base64') %>">
                    <% } else { %>
                        <img src="/img/default-avatar.png" alt="No photo">
                    <% } %>

                    <h3 class="home-head"><%= result[i].relName %></h3>
                    <p class="relation">Your <%= result[i].relation %></p>
                </div>
            <% } %>
        </div>

        <div id="reminders">
            <h2>Reminders</h2>
            <p><%= msg %></p>
            <table>
                <tr>
                    <th>Time</th>
                    <th>Message</th>
                </tr>
                <% for(let i=0; i<myreminders.length; i++){ %>
                    <tr>
                        <td><%= myreminders[i].time %></td>
                        <td><%= myreminders[i].tag %></td>
                    </tr>
                <% } %>
            </table>
        </div>
    </div>
</body>
</html>
